<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"        "http://www.w3.org/TR/html4/loose.dtd"><html><head>	<title>Blue Mango Multimedia Documentation</title>		<link rel="stylesheet" type="text/css" href="bmm-code.css" /></head><body><h1>libDatabaseObjects</h1><p><p> library of helper functions for linking database records to Revolution objects. Use the DBObjectsPalette.rev stack included with this distrubtion in order to set the necessary custom properties for use with dbobj_build.</p><p>	<span class="tag-prop-name">Author: </span>	<span class="tag-prop-desc">Trevor DeVore</span><br />	<span class="tag-prop-name">Copyright: </span>	<span class="tag-prop-desc">Blue Mango Learning Systems</span><br />	<span class="tag-prop-name">Version: </span>	<span class="tag-prop-desc">1.0.2.6</span><br />	<span class="tag-prop-name">Modified: </span>	<span class="tag-prop-desc">March 6 2005</span><br />	<span class="tag-prop-name">URL: </span>	<span class="tag-prop-desc"><a href="http://www.bluemangolearning.com/developer/revolution">http://www.bluemangolearning.com/developer/revolution</a></span><br />	<span class="tag-prop-name">URL: </span>	<span class="tag-prop-desc"><a href="mailto:trevor@mangomultimedia.com">mailto:trevor@mangomultimedia.com</a></span><br /></p><p><b>Handlers</b> - <a href="#dbobj_addData">dbobj_addData</a>, <a href="#dbobj_build">dbobj_build</a>, <a href="#dbobj_buildButton">dbobj_buildButton</a>, <a href="#dbobj_buildField">dbobj_buildField</a>, <a href="#dbobj_parseFormatter">dbobj_parseFormatter</a>, <a href="#dbobj_setRecordCountStrings">dbobj_setRecordCountStrings</a>, <a href="#dbobj_setSelectedText">dbobj_setSelectedText</a>, <a href="#dbobj_setupTabStops">dbobj_setupTabStops</a>, <a href="#dbobj_updateButtonRecord">dbobj_updateButtonRecord</a>, <a href="#dbobj_updateStats">dbobj_updateStats</a>, <a href="#uDBID">uDBID()</a></p><p><b>Utilities</b> - <a href="#dbobj_addRecord">dbobj_addRecord</a>, <a href="#dbobj_deleteRecords">dbobj_deleteRecords</a>, <a href="#dbobj_updateRecord">dbobj_updateRecord</a>, <a href="#uDBID[pNoMsgs]">uDBID[pNoMsgs]</a></p>	<div class="handler">	<a name="dbobj_addRecord"></a><span class="handler-type">command </span><span class="handler-name">dbobj_addRecord </span><span class="handler-params">pObj, pID, pText, pSortByCol, pSelect</span><br />	<div class="handler-details">		<span class="handler-desc-name">Description:</span>		<div class="handler-desc-body"> Adds an entry to a database object.  This can be used after adding a new record to a currently existing list.  IF pSelect is not false THEN the uDBID of the object will be set AND accompanying messages will be sent (selectionChanged OR menuPick) as long as messages are not locked.</div>		<span class="handler-desc-name">Parameters:</span>		<div class="handler-desc-body">			<span class="param-name">pObj:</span>			<span class="param-desc">Object to add to.</span><br />			<span class="param-name">pID:</span>			<span class="param-desc">Database id to add.</span><br />			<span class="param-name">pText:</span>			<span class="param-desc">new text.  text is inserted into column 1 to -2.  Tab delimit multiple columns.</span><br />			<span class="param-name">pSortByCol:</span>			<span class="param-desc">pass in a column number to sort by that column after the new text is inserted.  For buttons any positive integer will sort the button.</span><br />			<span class="param-name">pSelect:</span>			<span class="param-desc">By default, the new record is selected.  pass false to not select the new record.</span><br />		</div>		<span class="handler-desc-name">Return:</span>		<div class="handler-desc-body">empty</div>	</div></div><div class="handler">	<a name="dbobj_build"></a><span class="handler-type">command </span><span class="handler-name">dbobj_build </span><span class="handler-params">pObj, pData, pIDs, pPrependData, pAppendData</span><br />	<div class="handler-details">		<span class="handler-desc-name">Description:</span>		<div class="handler-desc-body"> Creates a button, field OR EnhancedField from database records.  The object can THEN track the database record id of the object based ON the selected line.  pass empty value for pData to reset object. <p>About cursor arrays - A cursor array is an array returned by libdb_openCursor().  By DEFAULT this handler will close the cursor that the cursor array contains.  IF you would like to keep the cursor open after calling dbobj_build THEN add a key to the cursor array named "CloseCuror" AND set the value to false.</div>		<span class="handler-desc-name">Parameters:</span>		<div class="handler-desc-body">			<span class="param-name">pObj:</span>			<span class="param-desc">long id of target button object.</span><br />			<span class="param-name">pData:</span>			<span class="param-desc">A cursor array, db array returned from libdb_getTableRecords OR line/tab delimited list from libdb_dataFromSQL.</span><br />			<span class="param-name">pIDs:</span>			<span class="param-desc">id to select initially.  Can be a comma delimited list for fields.</span><br />			<span class="param-name">pPrependData:</span>			<span class="param-desc">Data to prepend to object data. [ID,COLUMNS].  id is 0 IF not provided.</span><br />			<span class="param-name">pAppendData:</span>			<span class="param-desc">Data to append to object data. [ID,COLUMNS].  id is 0 IF not provided.</span><br />		</div>		<span class="handler-desc-name">Return:</span>		<div class="handler-desc-body">Returns "id not found" IF pIDs were not in records.  throw errors</div>	</div></div><div class="handler">	<a name="dbobj_deleteRecords"></a><span class="handler-type">command </span><span class="handler-name">dbobj_deleteRecords </span><span class="handler-params">pObj, pIDs</span><br />	<div class="handler-details">		<span class="handler-desc-name">Description:</span>		<div class="handler-desc-body"> Removes the records in database object that match pIDs.  The uDBID of the object will be set to the newly selected line AND accompanying messages will be sent (selectionChanged OR menuPick) as long as messages are not locked. <p>This can be used to delete records from an object after deleting records using a SQL call.</div>		<span class="handler-desc-name">Parameters:</span>		<div class="handler-desc-body">			<span class="param-name">pObj:</span>			<span class="param-desc">Object to delete from.</span><br />			<span class="param-name">pIDs:</span>			<span class="param-desc">record ids to delete.  Comma delimited.</span><br />		</div>		<span class="handler-desc-name">Return:</span>		<div class="handler-desc-body">empty</div>	</div></div><div class="handler">	<a name="dbobj_setRecordCountStrings"></a><span class="handler-type">command </span><span class="handler-name">dbobj_setRecordCountStrings </span><span class="handler-params">pPlural, pSingular</span><br />	<div class="handler-details">		<span class="handler-desc-name">Description:</span>		<div class="handler-desc-body"> Sets the string to pass to format for displaying the number of records in dbobj_build. DEFAULT is "%s records".  This is useful for localization purposes.</div>		<span class="handler-desc-name">Parameters:</span>		<div class="handler-desc-body">			<span class="param-name">pPlural:</span>			<span class="param-desc">String used when many strings are found.  DEFAULT IF pSingular is empty.</span><br />			<span class="param-name">pSingular:</span>			<span class="param-desc">String used when only 1 record was found.</span><br />		</div>		<span class="handler-desc-name">Return:</span>		<div class="handler-desc-body">empty</div>	</div></div><div class="handler">	<a name="dbobj_setSelectedText"></a><span class="handler-type">command </span><span class="handler-name">dbobj_setSelectedText </span><span class="handler-params">pObj, pText, pColumn, pNoMsgs</span><br />	<div class="handler-details">		<span class="handler-desc-name">Description:</span>		<div class="handler-desc-body"> Sets the hilited text of a button OR field.  pass true for pNoMsgs to lock messages while setting the text.  This keeps the menuPick OR selectionChanged messages from being sent.</div>		<span class="handler-desc-name">Parameters:</span>		<div class="handler-desc-body">			<span class="param-name">pObj:</span>			<span class="param-desc">long id of object to act on.</span><br />			<span class="param-name">pText:</span>			<span class="param-desc">text to select.</span><br />			<span class="param-name">pColumn:</span>			<span class="param-desc">IF pObj is a field THEN the column to search on.  DEFAULT is 1.</span><br />			<span class="param-name">pNoMsgs:</span>			<span class="param-desc">set to true to block messages.</span><br />		</div>		<span class="handler-desc-name">Return:</span>		<div class="handler-desc-body">empty</div>	</div></div><div class="handler">	<a name="dbobj_updateRecord"></a><span class="handler-type">command </span><span class="handler-name">dbobj_updateRecord </span><span class="handler-params">pObj, pID, pText, pSortByCol</span><br />	<div class="handler-details">		<span class="handler-desc-name">Description:</span>		<div class="handler-desc-body"> Modifies the text of a button OR the column of a field to the specified value. The line is found by matching the value of pID to the uDBID of the object.  Note that IF you supply pSortByCol for a button that the prepend AND append values you supplied to dbobj_build will not be sorted.  These values are left at the beginning AND END of the menu button AND only the lines inbetween will be sorted. <p> This command can be used to update the text of an object after updating text in the database using a SQL call.</div>		<span class="handler-desc-name">Parameters:</span>		<div class="handler-desc-body">			<span class="param-name">pObj:</span>			<span class="param-desc">long id of object to act on.</span><br />			<span class="param-name">pID:</span>			<span class="param-desc">Database id.</span><br />			<span class="param-name">pText:</span>			<span class="param-desc">new text.  text is inserted into column 1 to -2.  Tab delimit multiple columns.</span><br />			<span class="param-name">pSortByCol:</span>			<span class="param-desc">pass in a column number to sort by that column after the new text is inserted.  For buttons any positive integer will sort the button.</span><br />		</div>		<span class="handler-desc-name">Return:</span>		<div class="handler-desc-body">empty</div>	</div></div><div class="handler">	<a name="uDBID"></a><span class="handler-type">getprop </span><span class="handler-name">uDBID </span><span class="handler-params"></span><br />	<div class="handler-details">		<span class="handler-desc-name">Description:</span>		<div class="handler-desc-body"> Returns the database id associated with an object.  IF an object actually has a uDBID property value THEN that value is returned.  Otherwise the following rules apply: <p>For fields it is item -1 (of a tab delimited field) of the hilitedLines.  For buttons it is id in the uDBObj["DBIDs"] that equals the lineoffset of the selectedText(). For a group of radio buttons it is uDBID of the hilitedbutton of the group.  All other objects return the actual value of the uDBID of the object.</p></div>		<span class="handler-desc-name">Return:</span>		<div class="handler-desc-body">Database ID(s)</div>	</div></div><div class="handler">	<a name="uDBID[pNoMsgs]"></a><span class="handler-type">setprop </span><span class="handler-name">uDBID[pNoMsgs] </span><span class="handler-params">pID</span><br />	<div class="handler-details">		<span class="handler-desc-name">Description:</span>		<div class="handler-desc-body"> IF the uDBID property of the object exists THEN the value is set.  Otherwise the following rules apply: <p>Selects the label of a button, field OR group (radio button) with the given record id. pass a comma separated list of ids to select multiple lines of a field.</p> <p>This handler will set the menuhistory of a button OR send selectionChanged to a field. IF you don't want the menuPick handler to be sent THEN make the following call: set the uDBID["nomsg"] of theObject...</p></div>		<span class="handler-desc-name">Parameters:</span>		<div class="handler-desc-body">			<span class="param-name">pID:</span>			<span class="param-desc">ID(s) to select.</span><br />		</div>	</div></div></body></html>